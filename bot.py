import os
import telebot
from telebot import types

# –ß–∏—Ç–∞–µ–º —Ç–æ–∫–µ–Ω –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –æ–∫—Ä—É–∂–µ–Ω–∏—è
BOT_TOKEN = os.environ.get("BOT_TOKEN")
if not BOT_TOKEN:
    raise ValueError("–ù–µ –Ω–∞–π–¥–µ–Ω BOT_TOKEN –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è!")

bot = telebot.TeleBot(BOT_TOKEN)

# –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è –º–æ–¥–µ–ª–µ–π
instructions = {
    "T90": """–ò–ù–°–¢–†–£–ö–¶–ò–Ø –ü–û –ü–†–ò–ú–ï–ù–ï–ù–ò–Æ
–ë–ï–°–ü–†–û–í–û–î–ù–´–• –ù–ê–£–®–ù–ò–ö–û–í T-90
1) –î–æ—Å—Ç–∞–Ω—å—Ç–µ –Ω–∞—É—à–Ω–∏–∫–∏ –∏–∑ —É–ø–∞–∫–æ–≤–∫–∏ –∏ –ø–æ–º–µ—Å—Ç–∏—Ç–µ –∏—Ö –≤ –∑–∞—Ä—è–¥–Ω—ã–π –∫–µ–π—Å
2) –ü–æ–¥–∫–ª—é—á–∏—Ç–µ –∫–µ–π—Å —Å –Ω–∞—É—à–Ω–∏–∫–∞–º–∏ –∫ –∏—Å—Ç–æ—á–Ω–∏–∫—É –ø–∏—Ç–∞–Ω–∏—è –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ —Å—Ç–∞—Ä—Ç–æ–≤—É—é –∑–∞—Ä—è–¥–∫—É –Ω–µ –º–µ–Ω–µ–µ 4-5 —á–∞—Å–æ–≤.
3) –í–æ –≤—Ä–µ–º—è –∑–∞—Ä—è–¥–∫–∏ –Ω–∞—É—à–Ω–∏–∫–æ–≤ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –Ω–∞ –Ω–∏—Ö –≥–æ—Ä–∏—Ç –∫—Ä–∞—Å–Ω—ã–º, –∞ —Ç–∞–∫–∂–µ –ø—Ä–æ—Ü–µ—Å—Å –∑–∞—Ä—è–¥–∫–∏ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –Ω–∞ –¥–∏—Å–ø–ª–µ–µ.
4) –£—Ä–æ–≤–µ–Ω—å –∑–∞—Ä—è–¥–∞ –∫–µ–π—Å–∞ —Ç–∞–∫–∂–µ –≤–∏–¥–µ–Ω –Ω–∞ —Ü–∏—Ñ—Ä–æ–≤–æ–º –¥–∏—Å–ø–ª–µ–µ.
5) –î–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ —Ç–µ–ª–µ—Ñ–æ–Ω—É –¥–æ—Å—Ç–∞–Ω—å—Ç–µ –æ–±–∞ –Ω–∞—É—à–Ω–∏–∫–∞ –∏–∑ –∫–µ–π—Å–∞. –û–Ω–∏ –Ω–∞—á–Ω—É—Ç –º–∏–≥–∞—Ç—å –ø–æ–ø–µ—Ä–µ–º–µ–Ω–Ω–æ –∫—Ä–∞—Å–Ω–æ-—Å–∏–Ω–∏–º —Ü–≤–µ—Ç–æ–º, –∑–∞—Ç–µ–º –º–∏–≥–∞—Ç—å –±—É–¥–µ—Ç —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω.
–≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç —á—Ç–æ –Ω–∞—É—à–Ω–∏–∫–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–ª–∏—Å—å –≤ –ø–∞—Ä—É –∏ –≥–æ—Ç–æ–≤—ã –∫ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—é –∫ —Ç–µ–ª–µ—Ñ–æ–Ω—É.
6) –ï—Å–ª–∏ –Ω–µ –ø—Ä–æ–∏–∑–æ—à–ª–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ, –∑–∞–π–¥–∏—Ç–µ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ Bluetooth –∏ –Ω–∞–π–¥–∏—Ç–µ "M90 PRO", –ø–æ–¥–∫–ª—é—á–∏—Ç–µ.
7) –î–∞–ª–µ–µ –Ω–∞—É—à–Ω–∏–∫–∏ –±—É–¥—É—Ç –ø–æ–¥–∫–ª—é—á–∞—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.

–°–ï–ù–°–û–†–ù–û–ï –£–ü–†–ê–í–õ–ï–ù–ò–ï:
–í–∫–ª—é—á–∏—Ç—å/–≤—ã–∫–ª—é—á–∏—Ç—å - 5 —Å–µ–∫ —É–¥–µ—Ä–∂–∞–Ω–∏—è —Å–µ–Ω—Å–æ—Ä–∞
–ü–∞—É–∑–∞/–í–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ - 1 –∫–∞—Å–∞–Ω–∏–µ
–ü—Ä–∏–Ω—è—Ç—å/–û—Ç–±–æ–π –≤—ã–∑–æ–≤–∞ - 1 –∫–∞—Å–∞–Ω–∏–µ
–û—Ç–∫–ª–æ–Ω–∏—Ç—å –≤—ã–∑–æ–≤ - —É–¥–µ—Ä–∂–∏–≤–∞—Ç—å 1 —Å–µ–∫
–†–µ–≥—É–ª–∏—Ä–æ–≤–∫–∞ –≥—Ä–æ–º–∫–æ—Å—Ç–∏ - 3 –∫–∞—Å–∞–Ω–∏—è
–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ç—Ä–µ–∫ - 2 –∫–∞—Å–∞–Ω–∏—è
–í—ã–∑–æ–≤ Siri - 3 —Å–µ–∫ —É–¥–µ—Ä–∂–∞–Ω–∏—è

–ü—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è:
- –ù–µ –≤–∫–ª—é—á–∞—é—Ç—Å—è: –∑–∞—Ä—è–¥–∏—Ç–µ 10 –º–∏–Ω—É—Ç, —É–¥–µ—Ä–∂–∏–≤–∞–π—Ç–µ –∫–Ω–æ–ø–∫—É 10 —Å–µ–∫
- –ü–ª–æ—Ö–æ–π –∑–≤—É–∫: —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ —Ä—è–¥–æ–º (–¥–æ 10 –º)
- –ù–µ –∑–∞—Ä—è–∂–∞–µ—Ç—Å—è: –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–∞–±–µ–ª—å –∏ –æ—á–∏—Å—Ç–∏—Ç–µ –∫–æ–Ω—Ç–∞–∫—Ç—ã

–ï—Å–ª–∏ –Ω–µ –ø–æ–ª—É—á–∏–ª–æ—Å—å —Ä–µ—à–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—É, –æ–±—Ä–∞—Ç–∏—Ç–µ—Å—å: @dolmartik""",

    "Dots 8s": """–ò–ù–°–¢–†–£–ö–¶–ò–Ø –ü–û –ü–û–î–ö–õ–Æ–ß–ï–ù–ò–Æ Dots 8s
1) –°–Ω–∏–º–∏—Ç–µ –∑–∞—â–∏—Ç–Ω—ã–µ –ø–ª–µ–Ω–∫–∏ –∏ –∑–∞—Ä—è–¥–∏—Ç–µ –Ω–∞—É—à–Ω–∏–∫–∏
2) –í–∫–ª—é—á–∏—Ç–µ Bluetooth
3) –í–æ–∑—å–º–∏—Ç–µ –ø—Ä–∞–≤—ã–π –Ω–∞—É—à–Ω–∏–∫, –ø–æ–¥–∫–ª—é—á–∏—Ç–µ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö
4) –í–æ–∑—å–º–∏—Ç–µ –ª–µ–≤—ã–π ‚Äî –æ–Ω —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç—Å—è
5) –î–∞–ª–µ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –±—É–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º

–ü—Ä–æ–±–ª–µ–º—ã:
- –ù–µ –≤–∫–ª—é—á–∞—é—Ç—Å—è: –∑–∞—Ä—è–¥–∏—Ç–µ, —É–¥–µ—Ä–∂–∏–≤–∞–π—Ç–µ 10 —Å–µ–∫
- –ù–µ—Ç –∑–≤—É–∫–∞ –≤ –æ–¥–Ω–æ–º —É—Ö–µ: –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ—Å–∞–¥–∫—É –∏ —á–∏—Å—Ç–æ—Ç—É
- –ü–ª–æ—Ö–æ–π –∑–≤—É–∫: —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ –∑–æ–Ω–µ –¥–µ–π—Å—Ç–≤–∏—è Bluetooth
- –ë—ã—Å—Ç—Ä–æ —Ä–∞–∑—Ä—è–∂–∞—é—Ç—Å—è: –∑–∞—Ä—è–¥–∏—Ç–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é, –æ—Ç–∫–ª—é—á–∏—Ç–µ –ª–∏—à–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏

–ï—Å–ª–∏ –Ω–µ –ø–æ–ª—É—á–∏–ª–æ—Å—å —Ä–µ—à–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—É, –æ–±—Ä–∞—Ç–∏—Ç–µ—Å—å: @dolmartik""",

    "G36": """–ö–ê–ö –ü–û–î–ö–õ–Æ–ß–ò–¢–¨ G36
1) –û—Ç–∫—Ä–æ–π—Ç–µ –∫–µ–π—Å –∏ –∑–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –Ω–∞ –Ω–µ–º 2-3 —Å–µ–∫ (–∏–ª–∏ –Ω–∞ –Ω–∞—É—à–Ω–∏–∫–∞—Ö 7 —Å–µ–∫)
2) –í–∫–ª—é—á–∏—Ç–µ Bluetooth, –≤—ã–±–µ—Ä–∏—Ç–µ –º–æ–¥–µ–ª—å –≤ —Å–ø–∏—Å–∫–µ
3) –ü–æ–≤—Ç–æ—Ä–Ω–æ —ç—Ç–∏ —à–∞–≥–∏ –¥–µ–ª–∞—Ç—å –Ω–µ –Ω—É–∂–Ω–æ ‚Äî –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –±—É–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º

–ü—Ä–∏ –æ—à–∏–±–∫–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è:
1) –£–¥–∞–ª–∏—Ç–µ —Å—Ç–∞—Ä—ã–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
2) –°–±—Ä–æ—Å—å—Ç–µ –Ω–∞—É—à–Ω–∏–∫–∏
3) –ü–æ–ª–æ–∂–∏—Ç–µ –≤ –∫–µ–π—Å –Ω–∞ 30 —Å–µ–∫, –¥–æ—Å—Ç–∞–Ω—å—Ç–µ
4) –ß–µ—Ä–µ–∑ 5-10 —Å–µ–∫ –æ–Ω–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É—é—Ç—Å—è
5) –ü–æ–¥–∫–ª—é—á–∏—Ç–µ —Å–Ω–æ–≤–∞

–ï—Å–ª–∏ –Ω–µ –ø–æ–ª—É—á–∏–ª–æ—Å—å —Ä–µ—à–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—É, –æ–±—Ä–∞—Ç–∏—Ç–µ—Å—å: @dolmartik""",

    "TWS MAX": """–ü–û–î–ö–õ–Æ–ß–ï–ù–ò–ï TWS MAX
1) –í–∫–ª—é—á–∏—Ç–µ ‚Äî —É–¥–µ—Ä–∂–∏–≤–∞–π—Ç–µ 3 —Å–µ–∫
2) –í–∫–ª—é—á–∏—Ç–µ Bluetooth, –≤—ã–±–µ—Ä–∏—Ç–µ "P9"
3) –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ

–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:
- –û–¥–∏–Ω –∫–ª–∏–∫ ‚Äî –ø–∞—É–∑–∞/–≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ
- –î–≤–æ–π–Ω–æ–π –∫–ª–∏–∫ –ø—Ä–∞–≤–æ–≥–æ ‚Äî —Å–ª–µ–¥—É—é—â–∏–π —Ç—Ä–µ–∫
- –î–≤–æ–π–Ω–æ–π –∫–ª–∏–∫ –ª–µ–≤–æ–≥–æ ‚Äî –ø—Ä–µ–¥—ã–¥—É—â–∏–π
- –£–¥–µ—Ä–∂–∞–Ω–∏–µ 1 —Å–µ–∫ ‚Äî –≥–æ–ª–æ—Å–æ–≤–æ–π –ø–æ–º–æ—â–Ω–∏–∫

–ï—Å–ª–∏ –Ω–µ –ø–æ–ª—É—á–∏–ª–æ—Å—å —Ä–µ—à–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—É, –æ–±—Ä–∞—Ç–∏—Ç–µ—Å—å: @dolmartik""",

    "F6-s": """–ò–ù–°–¢–†–£–ö–¶–ò–Ø F6-s
1) –ó–∞—Ä—è–¥–∏—Ç–µ –Ω–∞—É—à–Ω–∏–∫–∏ –∏ –±–æ–∫—Å –º–∏–Ω–∏–º—É–º –¥–æ 20%
2) –£–¥–∞–ª–∏—Ç–µ —Å—Ç–∞—Ä–æ–µ —Å–æ–ø—Ä—è–∂–µ–Ω–∏–µ, –≤—ã–∫–ª—é—á–∏—Ç–µ Bluetooth
3) –•–∞—Ä–¥ —Ä–µ—Å–µ—Ç ‚Äî —É–¥–µ—Ä–∂–∞–Ω–∏–µ –∫–Ω–æ–ø–æ–∫ 10 —Å–µ–∫
4) –ü–æ–≤—Ç–æ—Ä–Ω–æ —É–¥–µ—Ä–∂–∏–≤–∞–π—Ç–µ 30 —Å–µ–∫, –ø–æ–∫–∞ –Ω–µ –º–æ—Ä–≥–Ω—É—Ç 3 —Ä–∞–∑–∞
5) –ü–æ–ª–æ–∂–∏—Ç–µ –≤ –∫–µ–π—Å –Ω–∞ 10 —Å–µ–∫
6) –í–∫–ª—é—á–∏—Ç–µ Bluetooth, —Å–æ–∑–¥–∞–π—Ç–µ —Å–æ–ø—Ä—è–∂–µ–Ω–∏–µ

–ï—Å–ª–∏ –Ω–µ –ø–æ–ª—É—á–∏–ª–æ—Å—å —Ä–µ—à–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—É, –æ–±—Ä–∞—Ç–∏—Ç–µ—Å—å: @dolmartik""",
}

# –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
def main_menu(chat_id):
    markup = types.ReplyKeyboardMarkup(resize_keyboard=True)
    markup.add("üéß –ù–∞—É—à–Ω–∏–∫–∏")
    bot.send_message(chat_id, "–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é —Ç–æ–≤–∞—Ä–∞:", reply_markup=markup)

# –ú–æ–¥–µ–ª–∏ –Ω–∞—É—à–Ω–∏–∫–æ–≤
def headphones_menu(chat_id):
    markup = types.ReplyKeyboardMarkup(resize_keyboard=True)
    models = ["T90", "Dots 8s", "G36", "TWS MAX", "F6-s", "TWS Air 2Pods", "TWS PRO", "N13", "‚¨Ö –ù–∞–∑–∞–¥", "üè† –°—Ç–∞—Ä—Ç"]
    markup.add(*models)
    bot.send_message(chat_id, "–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ –º–æ–¥–µ–ª—å —Ç–æ–≤–∞—Ä–∞ –∏–∑ —Å–ø–∏—Å–∫–∞ –Ω–∏–∂–µ, –¥–∞–Ω–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –í—ã –º–æ–∂–µ—Ç–µ –Ω–∞–π—Ç–∏ –Ω–∞ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–π –∫–æ—Ä–æ–±–∫–µ", reply_markup=markup)

# –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–º–∞–Ω–¥ /start
@bot.message_handler(commands=['start'])
def start(message):
    bot.send_message(message.chat.id, "–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å! üëã")
    main_menu(message.chat.id)

# –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞–∂–∞—Ç–∏–π
@bot.message_handler(func=lambda m: True)
def handle_message(message):
    if message.text == "üéß –ù–∞—É—à–Ω–∏–∫–∏":
        headphones_menu(message.chat.id)
    elif message.text in instructions:
        bot.send_message(message.chat.id, instructions[message.text])
    elif message.text in ["TWS Air 2Pods", "TWS PRO", "N13"]:
        bot.send_message(message.chat.id, no_instruction_text)
    elif message.text == "‚¨Ö –ù–∞–∑–∞–¥":
        main_menu(message.chat.id)
    elif message.text == "üè† –°—Ç–∞—Ä—Ç":
        start(message)
    else:
        bot.send_message(message.chat.id, "–ù–µ –ø–æ–Ω—è–ª –∫–æ–º–∞–Ω–¥—É. –í—ã–±–µ—Ä–∏—Ç–µ –∏–∑ –º–µ–Ω—é.")

# Webhook –¥–ª—è Railway
@app.route(f"/{TOKEN}", methods=["POST"])
def webhook():
    bot.process_new_updates([telebot.types.Update.de_json(request.stream.read().decode("utf-8"))])
    return "OK", 200

@app.route("/")
def index():
    return "–ë–æ—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç!", 200

if __name__ == "__main__":
    # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ webhook
    bot.remove_webhook()
    bot.set_webhook(url=f"https://{os.environ.get('RAILWAY_STATIC_URL')}/{TOKEN}")
    app.run(host="0.0.0.0", port=int(os.environ.get("PORT", 5000)))
